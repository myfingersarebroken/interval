Async state machine and some methods

